<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Controle Financeiro Pessoal</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      max-width: 900px;
      background-color: #fff9c4; /* amarelo bem claro */
    }
    h1 {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    h1::before {
      content: "üí≥"; /* √≠cone de carteira/cart√£o */
      font-size: 1.4em;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
    }
    .error {
      color: red;
      font-size: 0.9em;
      display: none;
      margin-top: 2px;
    }
    .btn-submit {
      margin-top: 15px;
      padding: 10px 15px;
      background-color: #fbc02d; /* amarelo mais forte */
      border: none;
      color: #333;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-submit:hover {
      background-color: #f9a825;
    }
    #lista-transacoes {
      margin-top: 25px;
    }
    #lista-transacoes h2 {
      margin-top: 20px;
      margin-bottom: 8px;
    }
    #lista-transacoes ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    #lista-transacoes li {
      background: #fffde7;
      border: 1px solid #f0e68c;
      border-radius: 4px;
      padding: 8px;
      margin-top: 6px;
      display: flex;
      justify-content: space-between;
      font-size: 0.95em;
    }
    #lista-transacoes li.receita {
      border-left: 4px solid green;
    }
    #lista-transacoes li.despesa {
      border-left: 4px solid red;
    }
    #lista-transacoes li.poupanca {
      border-left: 4px solid blue;
    }

    /* Container para colocar os resumos lado a lado */
    .resumos-container {
      display: flex;
      gap: 16px;
      margin-top: 20px;
      flex-wrap: wrap;
    }
    .resumo-box {
      flex: 1 1 250px;
      padding: 10px;
      background: #fffde7;
      border-radius: 4px;
      border: 1px solid #f0e68c;
      font-size: 0.95em;
    }
    .resumo-box h2 {
      margin-top: 0;
      margin-bottom: 8px;
    }
    .resumo-box p {
      margin: 4px 0;
    }
  </style>
</head>
<body>

  <h1>Carteira de Controle Financeiro</h1>

  <!-- Campo para armazenar o sal√°rio mensal -->
  <label for="salario-mensal">Sal√°rio mensal (R$):</label>
  <input type="number" id="salario-mensal" step="0.01" min="0" placeholder="Sal√°rio: 2500.00" />
  <small>Este valor ser√° considerado no resumo como refer√™ncia de renda.</small>

  <form id="finance-form" novalidate>
    <label for="tipo">Tipo:</label>
    <select id="tipo" name="tipo" required>
      <option value="">Selecione</option>
      <option value="receita">Receita</option>

      <!-- Tipos de despesas -->
      <option value="despesa_fixa_essencial">Despesa Fixa Essencial</option>
      <option value="despesa_variavel_essencial">Despesa Vari√°vel Essencial</option>
      <option value="despesa_nao_essencial">Despesa N√£o Essencial (Lazer)</option>
      <option value="investimento_divida">Investimentos e D√≠vidas</option>

      <!-- Novo tipo: Poupan√ßa -->
      <option value="poupanca">Poupan√ßa</option>
    </select>
    <span class="error" id="tipo-error">Por favor, selecione o tipo.</span>

    <small>
      Exemplos:<br>
      ‚Ä¢ Despesa Fixa Essencial: Moradia, servi√ßos p√∫blicos, conv√™nio, escola, empr√©stimos.<br>
      ‚Ä¢ Despesa Vari√°vel Essencial: Alimenta√ß√£o, combust√≠vel, rem√©dios, higiene, vestu√°rio.<br>
      ‚Ä¢ Despesa N√£o Essencial: restaurantes, viagens, streaming, presentes.<br>
      ‚Ä¢ Investimentos e D√≠vidas: poupan√ßa, investimentos, cart√£o de cr√©dito, amortiza√ß√£o.<br>
      ‚Ä¢ Poupan√ßa: valores reservados para guardar.
    </small>

    <label for="valor">Valor (R$):</label>
    <input type="number" id="valor" name="valor" step="0.01" min="0.01" placeholder="Ex: 150.00" required />
    <span class="error" id="valor-error">Informe um valor maior que zero.</span>

    <label for="data">Data:</label>
    <input type="date" id="data" name="data" required />
    <span class="error" id="data-error">Informe uma data v√°lida.</span>

    <label for="categoria">Categoria:</label>
    <input type="text" id="categoria" name="categoria" placeholder="Ex: Aluguel, Luz, Supermercado, Netflix" required />
    <span class="error" id="categoria-error">Categoria √© obrigat√≥ria.</span>

    <label for="descricao">Descri√ß√£o:</label>
    <textarea id="descricao" name="descricao" rows="3" placeholder="Descri√ß√£o opcional"></textarea>

    <button type="submit" class="btn-submit">Adicionar √† Carteira</button>
  </form>

  <section id="lista-transacoes">
    <h2>Transa√ß√µes da Carteira</h2>
    <ul id="transacoes"></ul>
  </section>

  <!-- Tr√™s resumos lado a lado -->
  <div class="resumos-container">
    <section class="resumo-box" id="resumo-principal">
      <h2>Resumo</h2>
      <p><strong>Total de Receitas:</strong> <span id="total-receitas">R$ 0,00</span></p>
      <p><strong>Total de Despesas:</strong> <span id="total-despesas">R$ 0,00</span></p>
      <p><strong>Saldo (Receitas - Despesas):</strong> <span id="saldo">R$ 0,00</span></p>
    </section>

    <section class="resumo-box" id="resumo-gasto">
      <h2>Resumo de Gasto</h2>
      <p><strong>Sal√°rio mensal informado:</strong> <span id="salario-informado">R$ 0,00</span></p>
      <p><strong>Total Gasto:</strong> <span id="total-gasto">R$ 0,00</span></p>
      <p><strong>Sobra do Sal√°rio:</strong> <span id="sobra-salario">R$ 0,00</span></p>
    </section>

    <section class="resumo-box" id="resumo-poupanca">
      <h2>Resumo de Poupan√ßa</h2>
      <p><strong>Valor adicionado (√∫ltima opera√ß√£o):</strong> <span id="valor-adicionado-poupanca">R$ 0,00</span></p>
      <p><strong>Total de poupan√ßa:</strong> <span id="total-poupanca">R$ 0,00</span></p>
    </section>
  </div>

  <script>
    let salarioMensal = 0;
    let totalPoupanca = 0;
    let ultimoValorPoupanca = 0;

    // Atualiza o valor de sal√°rio quando o usu√°rio digitar
    document.getElementById('salario-mensal').addEventListener('change', function () {
      const v = parseFloat(this.value);
      salarioMensal = isNaN(v) || v < 0 ? 0 : v;
      document.getElementById('salario-informado').textContent = `R$ ${salarioMensal.toFixed(2)}`;
      atualizarResumo();
    });

    document.getElementById('finance-form').addEventListener('submit', function(event) {
      event.preventDefault();

      let formIsValid = true;

      const tipo = document.getElementById('tipo');
      const tipoError = document.getElementById('tipo-error');
      if (tipo.value === '') {
        tipoError.style.display = 'block';
        formIsValid = false;
      } else {
        tipoError.style.display = 'none';
      }

      const valor = document.getElementById('valor');
      const valorError = document.getElementById('valor-error');
      if (valor.value === '' || parseFloat(valor.value) <= 0) {
        valorError.style.display = 'block';
        formIsValid = false;
      } else {
        valorError.style.display = 'none';
      }

      const data = document.getElementById('data');
      const dataError = document.getElementById('data-error');
      if (data.value === '') {
        dataError.style.display = 'block';
        formIsValid = false;
      } else {
        dataError.style.display = 'none';
      }

      const categoria = document.getElementById('categoria');
      const categoriaError = document.getElementById('categoria-error');
      if (categoria.value.trim() === '') {
        categoriaError.style.display = 'block';
        formIsValid = false;
      } else {
        categoriaError.style.display = 'none';
      }

      if (formIsValid) {
        const valorNumero = parseFloat(valor.value);

        const dados = {
          tipo: tipo.value,
          valor: valorNumero,
          data: data.value,
          categoria: categoria.value.trim(),
          descricao: document.getElementById('descricao').value.trim()
        };

        // Atualiza controle de poupan√ßa se o tipo for poupan√ßa
        if (dados.tipo === 'poupanca') {
          ultimoValorPoupanca = valorNumero;
          totalPoupanca += valorNumero;
          document.getElementById('valor-adicionado-poupanca').textContent = `R$ ${ultimoValorPoupanca.toFixed(2)}`;
          document.getElementById('total-poupanca').textContent = `R$ ${totalPoupanca.toFixed(2)}`;
        }

        adicionarTransacaoNaCarteira(dados);
        atualizarResumo();

        alert('Dados validados com sucesso e adicionados √† carteira (simula√ß√£o).');

        this.reset();
      }
    });

    function adicionarTransacaoNaCarteira(dados) {
      const lista = document.getElementById('transacoes');
      const li = document.createElement('li');

      // Visual: receita em verde, poupan√ßa em azul, resto como despesa
      if (dados.tipo === 'receita') {
        li.classList.add('receita');
      } else if (dados.tipo === 'poupanca') {
        li.classList.add('poupanca');
      } else {
        li.classList.add('despesa');
      }

      const textoLeft = document.createElement('span');
      textoLeft.textContent = `${dados.data} - ${dados.categoria}${dados.descricao ? ' - ' + dados.descricao : ''}`;

      const textoRight = document.createElement('span');
      textoRight.textContent = `R$ ${dados.valor.toFixed(2)}`;

      li.appendChild(textoLeft);
      li.appendChild(textoRight);

      lista.appendChild(li);
    }

    function atualizarResumo() {
      const itens = document.querySelectorAll('#transacoes li');
      let totalReceitas = 0;
      let totalDespesas = 0;

      itens.forEach(li => {
        const valorTexto = li.querySelector('span:last-child').textContent.replace('R$','').trim();
        const valor = parseFloat(valorTexto.replace(',', '.')) || 0;

        if (li.classList.contains('receita')) {
          totalReceitas += valor;
        } else if (li.classList.contains('despesa')) {
          totalDespesas += valor;
        }
        // Poupan√ßa n√£o entra em receitas nem em despesas aqui
      });

      const saldo = totalReceitas - totalDespesas;
      const totalGasto = totalDespesas;                 // tudo que foi gasto
      const sobraSalario = salarioMensal - totalGasto;  // quanto sobra do sal√°rio

      // Resumo principal
      document.getElementById('total-receitas').textContent = `R$ ${totalReceitas.toFixed(2)}`;
      document.getElementById('total-despesas').textContent = `R$ ${totalDespesas.toFixed(2)}`;
      document.getElementById('saldo').textContent = `R$ ${saldo.toFixed(2)}`;

      // Resumo de gasto
      document.getElementById('total-gasto').textContent = `R$ ${totalGasto.toFixed(2)}`;
      document.getElementById('sobra-salario').textContent = `R$ ${sobraSalario.toFixed(2)}`;
    }
  </script>

</body>
</html>
